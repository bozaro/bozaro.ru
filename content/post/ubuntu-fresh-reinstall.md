---
date: 2010-04-10
title: Чистая устновка Ubuntu с сохранением установленных пакетов
slug: ubuntu-fresh-reinstall
tags:
 - ubuntu
 - apt-get
categories:
 - Ubuntu
menu: main
---

Периодически у меня возникает желание переставить систему с чистого листа. Это бывает вызвано разными причинами, но обычно связано с неудачной попыткой обновиться до какой-нибудь свежей альфа- или бета- версии дистрибутива.

Переустанавливать после этого все пакеты руками как-то лениво, поэтому я покопался и нашел способ проще.
<!--more-->
### Переустановка приложений, установленных вручную
Для получения списка всех пакетов, установленных вручную, можно воспользоваться командой:

    sudo aptitude search '~i !~M' -F '%p install' > packages-list

Для того, чтобы установить все пакеты из полученного списка, необходимо выполнить команды:

    sudo dpkg --set-selections < packages-list
    sudo apt-get update && sudo apt-get dselect-upgrade

Этот способ позволяет заново установить все ранее установленные вручную пакеты с сохранением зависимостей. Единственное но — для установки пакетов из сторонних репозитариев, их необходимо предварительно добавить в /etc/apt/sources.list.d.

### Переустнановка автоматически установленных приложений
Предыдущий вариант не поставит некоторые из автоматически установленных приложений. Если оно сильно надо (не понятно только зачем :) ), то список приложений, включая те, которые установлены по зависимостям, можно получить командой:

    sudo aptitude search ~M -F %p > autoremove-packages-list

Сказать системе, что они нужны нам, можно при помощи команды:

    sudo aptitude markauto `cat autoremove-packages-list`

### Оригинал статьи:
Оригинал статьи можно прочесть здесь:

 * http://blog.hanno-stock.de/archives/50